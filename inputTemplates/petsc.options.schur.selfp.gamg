# use a Schur Complement for the first set of solves

# set petsc ksp object and preconditioner
-rans2p_ksp_type gmres
-rans2p_ksp_gmres_restart 300
-rans2p_ksp_atol 1e-20
-rans2p_ksp_rtol 1e-6
-rans2p_ksp_gmres_modifiedgramschmidt

#-ransp2p_ksp_monitor_true_residual
#-help

# pc options
-rans2p_pc_fieldsplit_type schur 
-rans2p_pc_fieldsplit_schur_fact_type upper
-rans2p_pc_fieldsplit_schur_precondition selfp

# pressure block options
-rans2p_fieldsplit_pressure_ksp_type preonly  # This should always be turned on
-rans2p_fieldsplit_pressure_pc_type gamg
-rans2p_fieldsplit_pressure_pc_gamg_type agg
#-rans2p_fieldsplit_pressure_pc_gamg_threshold 0.0
#-rans2p_fieldsplit_pressure_pc_gamg_agg_nsmooths 1
#-rans2p_fieldsplit_pressure_pc_gamg
#-rans2p_fieldsplit_pressure_pc_type hypre
#-rans2p_fieldsplit_pressure_pc_type_hypre_type boomeramg
-rans2p_fieldsplit_pressure_ksp_constant_null_space
#-rans2p_fieldsplit_pressure_pc_factor_mat_solver_package superlu_dist

# direct solver for velocity block - ksp options
-rans2p_fieldsplit_velocity_ksp_type preonly
-rans2p_fieldsplit_velocity_pc_type lu
#-fieldsplit_velocity_ksp_view
#-fieldsplit_velocity_ksp_monitor_true_residual
#-fieldsplit_velocity_pc_factor_mat_solver_package superlu_dist
#-fieldsplit_velocity_ksp_converged_reason

### Options if selfp implemented through PETSc

#-innerSp_solve_ksp_type preonly
#-innerSp_solve_pc_type hypre
#-innerSp_solve_pc_hypre_type boomeramg
#-innerSp_solve_pc_factor_mat_solver_package superlu_dist

-ncls_ksp_type   gmres -ncls_pc_type   hypre -ncls_pc_hypre_type    boomeramg -ncls_ksp_gmres_restart 300 -ncls_ksp_knoll -ncls_ksp_max_it 2000
-vof_ksp_type    gmres -vof_pc_type    hypre -vof_pc_hypre_type     boomeramg -vof_ksp_gmres_restart 300 -vof_ksp_knoll -vof_ksp_max_it 2000
-rdls_ksp_type   gmres -rdls_pc_type asm -rdls_pc_asm_type basic -rdls_ksp_gmres_modifiedgramschmidt -rdls_ksp_gmres_restart 300 -rdls_ksp_knoll -rdls_sub_ksp_type preonly -rdls_sub_pc_factor_mat_solver_package superlu -rdls_sub_pc_type lu -rdls_ksp_max_it 2000
-mcorr_ksp_type  cg -mcorr_pc_type hypre -mcorr_pc_hypre_type boomeramg -mcorr_ksp_max_it 2000
-mesh_ksp_type cg -mesh_pc_type asm -mesh_pc_asm_type basic -mesh_ksp_max_it 2000
-mesh_sub_ksp_type preonly -mesh_sub_pc_factor_mat_solver_package superlu -mesh_ksp_knoll -mesh_sub_pc_type lu

# For optimal performance, log_summary should be turned off
#-log_summary